CREATE TABLE [dbo].[Shipment]
(
	[Id] INT NOT NULL PRIMARY KEY IDENTITY, 
    [ShipmentDate] DATETIME2 NOT NULL DEFAULT GETDATE(), 
    [TrackingId] NVARCHAR(128) NOT NULL, 
    [CourierName] NVARCHAR(128) NOT NULL, 
    [ItemName] NVARCHAR(128) NOT NULL, 
    [ItemCondition] NVARCHAR(128) NOT NULL, 
    [Remarks] NVARCHAR(MAX) NULL, 
    [ShipmentType] NVARCHAR(128) NOT NULL, 
    [CustomerName] NVARCHAR(128) NULL, 
    CONSTRAINT [CK_Shipment_Type] CHECK ([ShipmentType] = 'Inward' OR [ShipmentType] = 'Outward')
)


CREATE TABLE [dbo].[CourierName]
(
	[Id] INT NOT NULL PRIMARY KEY IDENTITY, 
    [Value] NVARCHAR(128) NOT NULL UNIQUE
)

GO

CREATE PROCEDURE [dbo].[InsertCourierName]
	@name nvarchar(128)
AS
	INSERT INTO [dbo].[CourierName]([Value]) VALUES (@name)

GO

CREATE PROCEDURE [dbo].[InsertShipment]
	@date       datetime2,
    @tracking   nvarchar(128),
    @courier    nvarchar(128),
    @item       nvarchar(128),
    @condition  nvarchar(128),
    @remarks    nvarchar(max),
    @type       nvarchar(128),
    @customer   nvarchar(128)
AS
    INSERT INTO [dbo].[Shipment]
           ([ShipmentDate]
           ,[TrackingId]
           ,[CourierName]
           ,[ItemName]
           ,[ItemCondition]
           ,[Remarks]
           ,[ShipmentType]
           ,[CustomerName])
     VALUES
           (@date     
           ,@tracking 
           ,@courier  
           ,@item     
           ,@condition
           ,@remarks  
           ,@type
           ,@customer)     

GO

CREATE FUNCTION [dbo].[IsCourierNameExists]
(
	@name nvarchar(128))
RETURNS BIT
AS
BEGIN
	DECLARE @count INT = (SELECT COUNT(*) FROM CourierName WHERE CourierName.[Value] = @name)
	IF (@count > 0)
		RETURN 1
	RETURN 0;
END

GO

CREATE FUNCTION [dbo].[GetCourierNames]
()
RETURNS TABLE
AS RETURN
	SELECT [Value] FROM dbo.CourierName

GO

CREATE FUNCTION [dbo].[GetInwardShipments]
()
RETURNS TABLE
AS
RETURN
	SELECT * FROM [dbo].[Shipment] WHERE [ShipmentType] = 'Inward'

GO

CREATE FUNCTION [dbo].[GetOutwardShipments]
()
RETURNS TABLE
AS
RETURN
	SELECT * FROM [dbo].[Shipment] WHERE [ShipmentType] = 'Outward'

GO